"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3677],{3677:(S,u,c)=>{c.r(u),c.d(u,{SearchPageModule:()=>k});var d=c(177),g=c(4341),i=c(7125),p=c(6454),m=c(467),e=c(9498),b=c(2872),C=c(6340),v=c(8831);function x(a,l){if(1&a){const s=e.RV6();e.j41(0,"ion-card",32),e.bIt("click",function(){const n=e.eBV(s).$implicit,r=e.XpG();return e.Njj(r.verDetalle(n))}),e.nrm(1,"ion-img",33),e.j41(2,"ion-card-header")(3,"ion-card-title",34),e.EFF(4),e.k0s()()()}if(2&a){const s=l.$implicit;e.R7$(),e.Y8G("src",s.imagen),e.R7$(3),e.Lme(" ",s.tipo," - $",s.precio," ")}}function F(a,l){1&a&&(e.j41(0,"ion-card",35)(1,"ion-card-header")(2,"ion-card-title"),e.EFF(3,"No hay propiedades que coincidan con los filtros."),e.k0s()()())}const _=[{path:"",component:(()=>{var a;class l{constructor(t,n,r,o,h){this.navCtrl=t,this.afs=n,this.afAuth=r,this.injector=o,this.loadingController=h,this.filtroTipo="",this.filtroUniversidad="",this.filtroPrecioMin=1e3,this.filtroPrecioMax=1e4,this.propiedades=[],this.universidades={UAQ:{lat:20.5889168,lng:-100.4185597},ITQ:{lat:20.593303,lng:-100.4103997},UTEQ:{lat:20.6539495,lng:-100.4086687},UVM:{lat:20.709205,lng:-100.4482555},UNAM:{lat:20.7048036,lng:-100.4484412}},this.noResults=!1}ngOnInit(){this.checkUserAuthentication()}checkUserAuthentication(){var t=this;return(0,m.A)(function*(){const n=localStorage.getItem("userData");if(!n)return void t.navCtrl.navigateRoot("/login");const r=JSON.parse(n);r&&"quiero-rentar"===r.userType?t.cargarPropiedades():t.navCtrl.navigateRoot("/login")})()}cargarPropiedades(){var t=this;return(0,m.A)(function*(){const n=yield t.loadingController.create({spinner:"bubbles",message:"Cargando propiedades...",translucent:!0,cssClass:"custom-loading"});yield n.present(),(0,e.N4e)(t.injector,()=>{t.afs.collection("properties").valueChanges({idField:"id"}).subscribe(r=>{t.propiedades=r.map(o=>({...o,precio:o.precio||5e3,distancia:10*Math.random(),imagen:o.imagenes&&o.imagenes.length>0?o.imagenes[0]:"assets/casa.png"})),console.log("Propiedades cargadas:",t.propiedades),n.dismiss()})})})()}verDetalle(t){console.log("Propiedad seleccionada:",t),console.log("ID de la propiedad:",t.id),this.navCtrl.navigateForward(["/detalle"],{state:{id:t.id}})}calcularDistancia(t,n,r,o){const f=this.degreesToRadians(r-t),M=this.degreesToRadians(o-n),P=Math.sin(f/2)*Math.sin(f/2)+Math.cos(this.degreesToRadians(t))*Math.cos(this.degreesToRadians(r))*Math.sin(M/2)*Math.sin(M/2);return 2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P))*6371}degreesToRadians(t){return t*(Math.PI/180)}aplicarFiltros(){let t=this.propiedades.filter(n=>(!this.filtroTipo||n.tipo===this.filtroTipo)&&n.precio>=this.filtroPrecioMin&&n.precio<=this.filtroPrecioMax);if(""!==this.filtroUniversidad){const n=this.universidades[this.filtroUniversidad];n&&n.lat&&n.lng?t=t.filter(r=>r.latitud&&r.longitud&&this.calcularDistancia(n.lat,n.lng,r.latitud,r.longitud)<=3):(console.error("Datos de la universidad o propiedad no encontrados:",this.filtroUniversidad),t=[])}return this.noResults=0===t.length,t}verCitas(){this.navCtrl.navigateForward("/mis-citas")}cerrarSesion(){localStorage.removeItem("userData"),this.navCtrl.navigateRoot("/login")}}return(a=l).\u0275fac=function(t){return new(t||a)(e.rXU(b.q9),e.rXU(C.Qe),e.rXU(v.DS),e.rXU(e.zZn),e.rXU(i.Xi))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-search"]],standalone:!1,decls:58,vars:6,consts:[["side","end","contentId","main-content"],["color","primary"],["button","",3,"click"],["name","calendar","slot","start"],["name","log-out","slot","start"],[1,"ion-text-center"],["slot","end"],["id","main-content",1,"ion-padding"],[1,"search-container"],[1,"custom-segment",3,"ngModelChange","ngModel"],["value","casa"],["name","home"],["value","departamento"],["name","business"],["value","cuarto"],["name","bed"],[1,"custom-segment","scrollable-segment",3,"ngModelChange","ngModel"],["value",""],["name","school"],["value","UAQ"],["value","ITQ"],["value","UTEQ"],["value","UVM"],["value","UNAM"],[1,"price-filter"],[1,"price-inputs"],["type","number","placeholder","M\xednimo","min","1000","max","10000","step","500",1,"price-input",3,"ngModelChange","ngModel"],[1,"dash"],["type","number","placeholder","M\xe1ximo","min","1000","max","10000","step","500",1,"price-input",3,"ngModelChange","ngModel"],[1,"custom-list"],["class","custom-card",3,"click",4,"ngFor","ngForOf"],["class","no-results-card",4,"ngIf"],[1,"custom-card",3,"click"],[1,"custom-img",3,"src"],[1,"custom-title"],[1,"no-results-card"]],template:function(t,n){1&t&&(e.j41(0,"ion-menu",0)(1,"ion-header")(2,"ion-toolbar",1)(3,"ion-title"),e.EFF(4,"Men\xfa"),e.k0s()()(),e.j41(5,"ion-content")(6,"ion-list")(7,"ion-item",2),e.bIt("click",function(){return n.verCitas()}),e.nrm(8,"ion-icon",3),e.j41(9,"ion-label"),e.EFF(10,"Ver citas"),e.k0s()(),e.j41(11,"ion-item",2),e.bIt("click",function(){return n.cerrarSesion()}),e.nrm(12,"ion-icon",4),e.j41(13,"ion-label"),e.EFF(14,"Cerrar sesi\xf3n"),e.k0s()()()()(),e.j41(15,"ion-header")(16,"ion-toolbar",1)(17,"ion-title",5),e.EFF(18,"\xbfQu\xe9 est\xe1s buscando?"),e.k0s(),e.j41(19,"ion-buttons",6),e.nrm(20,"ion-menu-button"),e.k0s()()(),e.j41(21,"ion-content",7)(22,"div",8)(23,"ion-segment",9),e.mxI("ngModelChange",function(o){return e.DH7(n.filtroTipo,o)||(n.filtroTipo=o),o}),e.j41(24,"ion-segment-button",10),e.nrm(25,"ion-icon",11),e.EFF(26," Casa "),e.k0s(),e.j41(27,"ion-segment-button",12),e.nrm(28,"ion-icon",13),e.EFF(29," Departamento "),e.k0s(),e.j41(30,"ion-segment-button",14),e.nrm(31,"ion-icon",15),e.EFF(32," Cuarto "),e.k0s()(),e.j41(33,"ion-segment",16),e.mxI("ngModelChange",function(o){return e.DH7(n.filtroUniversidad,o)||(n.filtroUniversidad=o),o}),e.j41(34,"ion-segment-button",17),e.nrm(35,"ion-icon",18),e.EFF(36," Todas "),e.k0s(),e.j41(37,"ion-segment-button",19),e.EFF(38," UAQ "),e.k0s(),e.j41(39,"ion-segment-button",20),e.EFF(40," ITQ "),e.k0s(),e.j41(41,"ion-segment-button",21),e.EFF(42," UTEQ "),e.k0s(),e.j41(43,"ion-segment-button",22),e.EFF(44," UVM "),e.k0s(),e.j41(45,"ion-segment-button",23),e.EFF(46," UNAM "),e.k0s()(),e.j41(47,"div",24)(48,"ion-label"),e.EFF(49,"Rango de Precios"),e.k0s(),e.j41(50,"div",25)(51,"ion-input",26),e.mxI("ngModelChange",function(o){return e.DH7(n.filtroPrecioMin,o)||(n.filtroPrecioMin=o),o}),e.k0s(),e.j41(52,"span",27),e.EFF(53,"-"),e.k0s(),e.j41(54,"ion-input",28),e.mxI("ngModelChange",function(o){return e.DH7(n.filtroPrecioMax,o)||(n.filtroPrecioMax=o),o}),e.k0s()()()(),e.j41(55,"ion-list",29),e.DNE(56,x,5,3,"ion-card",30)(57,F,4,0,"ion-card",31),e.k0s()()),2&t&&(e.R7$(23),e.R50("ngModel",n.filtroTipo),e.R7$(10),e.R50("ngModel",n.filtroUniversidad),e.R7$(18),e.R50("ngModel",n.filtroPrecioMin),e.R7$(3),e.R50("ngModel",n.filtroPrecioMax),e.R7$(2),e.Y8G("ngForOf",n.aplicarFiltros()),e.R7$(),e.Y8G("ngIf",n.noResults))},dependencies:[d.Sq,d.bT,g.BC,g.vS,i.QW,i.b_,i.ME,i.tN,i.W9,i.eU,i.iq,i.KW,i.$w,i.uz,i.he,i.nf,i.oS,i.MC,i.Gp,i.eP,i.BC,i.ai,i.su,i.Je,i.T6,i.jL],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: #3b82f6;--color: white;border-radius:0 0 20px 20px;box-shadow:0 2px 8px #0000001a}.custom-segment[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:15px;background-color:#f7f7f7;box-shadow:0 2px 10px #0000001a}.custom-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--color-checked: #3b82f6;--background-checked: #e3f2fd;padding:10px 15px;font-weight:500}.custom-segment[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:5px}.scrollable-segment[_ngcontent-%COMP%]{overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}.price-filter[_ngcontent-%COMP%]{margin-top:20px;background-color:#f7f7f7;padding:15px;border-radius:15px;box-shadow:0 2px 10px #0000001a;display:flex;justify-content:center;align-items:center;flex-direction:column}.price-inputs[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-top:10px;justify-content:center}.price-input[_ngcontent-%COMP%]{width:120px;padding:10px;border-radius:10px;border:1px solid #ddd;font-size:14px;background-color:#fff;transition:border-color .3s ease}.price-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6}.dash[_ngcontent-%COMP%]{font-size:18px;color:#555;font-weight:700}.custom-list[_ngcontent-%COMP%]{margin-top:20px;display:grid;grid-template-columns:1fr;gap:20px}@media (min-width: 1024px){.custom-list[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.custom-card[_ngcontent-%COMP%]{border-radius:12px;overflow:hidden;box-shadow:0 4px 15px #0000001a;margin-bottom:15px;transition:transform .3s ease,box-shadow .3s ease}.custom-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 6px 20px #0000001a}.custom-img[_ngcontent-%COMP%]{width:100%;height:150px;object-fit:cover;border-bottom:2px solid #eee}.custom-title[_ngcontent-%COMP%]{font-weight:600;color:#3b82f6;text-transform:capitalize;margin:10px;font-size:16px}.custom-card-content[_ngcontent-%COMP%]{padding:10px;font-size:14px;color:#555;font-weight:400}ion-card[_ngcontent-%COMP%]:hover{cursor:pointer}ion-card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#3b82f6}ion-content[_ngcontent-%COMP%]{--background: #f4f4f9}"]}),l})()}];let j=(()=>{var a;class l{}return(a=l).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[p.iI.forChild(_),p.iI]}),l})(),k=(()=>{var a;class l{}return(a=l).\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[d.MD,g.YN,i.bv,j]}),l})()}}]);